@model IEnumerable<HhcTst.Models.STATE>
@{
    ViewBag.Title = "Hhc";
    Layout = "~/Views/Shared/AdminLayout.cshtml";
}
<script src="~/Scripts/angular.js"></script>
<script type="text/javascript">
    
    //Module
    var myApp = angular.module('myApp', []);
    //Controller
    myApp.controller('MainCtrl', ['$scope', '$http',
        function ($scope, $http) {
            //$http service for Getting the Country
            $http({
                method: 'GET',
                url:'/STATEs/GetZones'
            }).
            success(function (data) {
                $scope.zone = data;
            });

            //$http service for getting States
            $scope.GetStates = function () {
                if ($scope.zone) {
                    $http({
                        method: 'POST',
                        url: '/STATEs/GetStates/',
                        data: JSON.stringify({ ZoneID: $scope.countr })
                    }).
                    success(function (data) {
                        $scope.states = data;
                    });
                }
                else {
                    $scope.cities = null;
                }
            }
        }]);
</script>  

<div data-ng-app="myApp">
    {{1+1}}
    <div data-ng-controller="MainCtrl">
        <div class="editor-label">
            <label>Name</label>
        </div>
        <div class="editor-field">
            @Html.TextBox("Name")
        </div>
        <div class="editor-label">
            <label>Zone</label><br />
        </div>
        <div class="editor-field">
            <select data-ng-model="zone"
                    data-ng-options="c.ZoneID as c.ZoneName for c in zone"
                    data-ng-change="GetStates()">
                <option value="">--Select Country--</option>
            </select><br />
        </div>
        <div class="editor-label">
            <br />
            <label>State</label><br />
        </div>
        <div class="editor-field">
            <select data-ng-model="state" data-ng-disabled="!states"
                    data-ng-options="s.StateID as s.StateName for s in states where c.ZoneID">
                <option value="">--Select State--</option>
            </select>
        </div>


    </div>
</div>  
<h2>States</h2>
<p> Populating With Database and EF</p>
@Html.DropDownList("Zones", (SelectList)ViewBag.Zones)
<p>
    @Html.ActionLink("Create New", "Create")
</p>

<table class="table table-hover">
    @*<tr>
        <td class="text-danger"> </td>
        <td>
        </td>
    </tr>*@
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.STATENAME)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Zone1.ZoneName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.ACTIVE)
        </th>
        <th>
            @Html.DisplayNameFor(model=>model.CreatedOn)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.STATENAME)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Zone1.ZoneName)
        </td>
        <td>
            @{if (item.ACTIVE == "y")
            {
                @Html.Label("Active")
                @*@Html.DisplayFor(modelItem => item.ACTIVE)*@
            }
            else if (item.ACTIVE == "n")
            {
                @Html.Label("DeActive")
            }

            }
            @*@Html.DisplayFor(modelItem => item.ACTIVE)*@
        </td>
        <td>
            @Html.DisplayFor(modelItem=>item.CreatedOn)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.STATEID }) |
            @*@Html.ActionLink("Details", "Details", new { id=item.STATEID }) |*@
            @*@Html.ActionLink("Delete", "Delete", new { id=item.STATEID })*@
            @{if (item.ACTIVE == "y")
            {

                //var v= (item.ACTIVE="n");
                @Html.ActionLink("DeActivate", "Active", new { id = item.STATEID })


            }

            else
            {
                @Html.ActionLink("Activate", "Active", new { id = item.STATEID })
            }
            }
        </td>
    </tr>
}

</table>
